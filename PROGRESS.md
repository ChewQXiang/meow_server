# LSA Platform 開發進度報告

## ✅ 已完成項目（穩定可 Demo）

### 1. 前端頁面系統 ✓
- [x] 登入頁面 - 現代化設計，移除 Demo 帳號顯示
- [x] 教師端頁面 - 題目管理、教材管理（UI 完成）
- [x] 學生端頁面 - 題目列表、VM 資訊、驗證流程
- [x] 統一設計風格 - 所有頁面使用一致的 CSS 和佈局

### 2. 後端 API 系統 ✓
- [x] 使用者認證 API - 登入、登出、角色檢查
- [x] 題目管理 API - 列表、單題查詢
- [x] 學生進度 API - 進度追蹤、驗證紀錄
- [x] VM 管理 API - 分配、重置、下一題
- [x] Proxmox 整合 - Clone、Snapshot、Rollback

### 3. 資料庫設計 ✓
- [x] 完整的 Schema 設計（8 個表）
- [x] users, questions, progress, attempts
- [x] classes, enrollments, vm_assignments
- [x] 索引和外鍵關聯

### 4. 題目腳本庫 ✓ **[本次完成]**
- [x] 20 個 Fault 注入腳本（fault_01.sh ~ fault_20.sh）
- [x] 20 個 Check 驗證腳本（check_01.sh ~ check_20.sh）
- [x] 腳本分類：
  - 服務管理 (6題)
  - 網路設定 (5題)
  - 檔案權限 (4題)
  - 系統管理 (3題)
  - 其他 (2題)
- [x] 難度分布：Easy(12) / Medium(12) / Hard(1)
- [x] 資料庫已更新 25 題（包含原有 5 題）

### 5. 部署文件 ✓
- [x] 腳本部署說明 (scripts/README.md)
- [x] SQL Seed 檔案（含 20 題完整資料）
- [x] 進度追蹤文件（本檔案）

---

## 📊 目前系統架構

```
┌─────────────────────────────────────────────────────────┐
│                    LSA Platform VM                       │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│  │  Web Frontend│  │  Express API │  │   MySQL DB   │ │
│  │  Login/UI    │  │  Auth/VM/Q   │  │   25 題資料  │ │
│  └──────────────┘  └──────────────┘  └──────────────┘ │
│                          │                              │
│                          ↓                              │
│              ┌──────────────────────┐                  │
│              │  Proxmox API Client  │                  │
│              │  Clone/Snapshot/SSH  │                  │
│              └──────────────────────┘                  │
└───────────────────────┼─────────────────────────────────┘
                        │
                        ↓
┌─────────────────────────────────────────────────────────┐
│                  Proxmox VE Server                       │
│     ┌────────────────────────────────────────┐          │
│     │         Template VM                    │          │
│     │  ┌──────────────┐  ┌──────────────┐  │          │
│     │  │ /opt/faults/ │  │ /opt/checks/ │  │          │
│     │  │  20 scripts  │  │  20 scripts  │  │          │
│     │  └──────────────┘  └──────────────┘  │          │
│     └────────────────────────────────────────┘          │
│                        │                                 │
│                        ↓ Clone                           │
│     ┌────────────────────────────────────────┐          │
│     │        Student VM (Per Student)        │          │
│     │   Snapshot: clean_start                │          │
│     └────────────────────────────────────────┘          │
└─────────────────────────────────────────────────────────┘
```

---

## 🎯 下一步工作（優先順序）

### 短期目標：讓系統能完整 Demo（1-2 週）

#### 1. **Template VM 建置** [高優先]
- [ ] 安裝基礎服務（nginx, ssh, apache, mysql, cron）
- [ ] 建立 /opt/faults 和 /opt/checks 目錄
- [ ] 複製腳本到 Template VM
- [ ] 設定 sudo 權限讓平台可以執行腳本
- [ ] 建立 clean_start snapshot

#### 2. **測試完整流程** [高優先]
- [ ] 學生登入 → 分配 VM
- [ ] 執行第 1 題 fault 腳本
- [ ] 學生手動修復
- [ ] 驗證功能測試
- [ ] Rollback + 下一題
- [ ] 完整跑完 5-10 題

#### 3. **教師題目管理功能** [中優先]
- [ ] 教師可以「啟用/停用」題目
- [ ] 教師可以「新增題目」並選擇 fault/check
- [ ] 教師可以查看「學生進度統計」
- [ ] （可選）教師可以「編輯題目描述」

#### 4. **學生體驗優化** [中優先]
- [ ] 學生頁面顯示「當前題目進度」（已完成 X/20）
- [ ] 提供「提示」功能（從 check 腳本的 hint 提取）
- [ ] 顯示「歷史嘗試記錄」
- [ ] （可選）WebSSH 整合或連線資訊優化

---

### 中期目標：穩定擴充（2-4 週）

#### 5. **擴充到 30-50 題** [中優先]
- [ ] 設計 10-30 個額外題目
- [ ] 編寫對應的 fault/check 腳本
- [ ] 分類與難度平衡
- [ ] 更新資料庫

#### 6. **教材管理系統** [低優先]
- [ ] 教師上傳 PDF/Markdown
- [ ] 教材與題目關聯
- [ ] 學生可查看相關教材

#### 7. **班級管理** [低優先]
- [ ] 教師建立班級
- [ ] 學生加入班級
- [ ] 班級進度統計

---

### 長期目標：AI/RAG 整合（1-2 個月）

#### 8. **RAG 出題系統** [亮點功能]
- [ ] 文件上傳與解析（PDF/Markdown）
- [ ] 向量化與檢索（Embedding）
- [ ] AI 根據教材生成題目描述
- [ ] AI 選擇合適的 fault 腳本
- [ ] 題目品質驗證

#### 9. **SRL 提示卡系統** [亮點功能]
- [ ] 分級提示生成（第一次：模糊提示、第二次：詳細、第三次：解答步驟）
- [ ] 根據學生錯誤日誌生成提示
- [ ] 提示卡 UI 設計

#### 10. **進階功能**
- [ ] 學生學習歷程分析
- [ ] 智能題目推薦
- [ ] 競賽模式
- [ ] 成就系統

---

## 🚀 立即可以開始的工作

### 給組員的任務分配建議

**組員 A - Template VM 工程師**
1. 建立乾淨的 Ubuntu VM
2. 安裝所需服務（nginx, apache, mysql, ssh, cron）
3. 複製 fault/check 腳本到 /opt/
4. 建立 snapshot

**組員 B - 後端 API 開發**
1. 完善教師題目管理 API
2. 新增題目啟用/停用功能
3. 學生進度統計 API

**組員 C - 前端 UI 優化**
1. 教師題目管理頁面優化
2. 學生進度顯示優化
3. 提示卡 UI 設計

**組員 D - 測試與文件**
1. 測試完整學生流程
2. 撰寫使用者手冊
3. 準備 Demo 簡報

---

## 📝 重要檔案位置

```
lsa-platform/
├── views/                    # 前端頁面
│   ├── login.html           # ✅ 完成
│   ├── teacher.html         # ✅ 完成
│   └── student.html         # ✅ 完成
│
├── src/
│   ├── app.js               # ✅ 主程式
│   ├── db.js                # ✅ 資料庫連線
│   ├── pve.js               # ✅ Proxmox 整合
│   ├── ssh.js               # ✅ SSH 執行
│   └── queue.js             # ✅ 任務佇列
│
├── scripts/                 # ✅ 新建立
│   ├── faults/              # ✅ 20 個故障腳本
│   ├── checks/              # ✅ 20 個驗證腳本
│   └── README.md            # ✅ 部署說明
│
├── sql/
│   ├── seed.sql             # 原有資料
│   └── seed_20_questions.sql # ✅ 20 題完整資料
│
└── PROGRESS.md              # ✅ 本檔案
```

---

## 🎓 展示建議

### MVP Demo 流程（15 分鐘）

1. **系統介紹** (2 分鐘)
   - 架構圖說明
   - 技術棧介紹

2. **教師端展示** (3 分鐘)
   - 登入系統
   - 查看題庫（20 題）
   - 查看學生進度

3. **學生端展示** (7 分鐘)
   - 學生登入
   - 點擊「開始訓練」→ 分配 VM
   - 看到第 1 題（Nginx 故障）
   - SSH 連線到 VM
   - 執行 `systemctl status nginx`（失敗）
   - 執行 `sudo systemctl start nginx`（修復）
   - 點擊「驗證」→ 通過 ✅
   - 點擊「下一題」→ VM rollback + 注入第 2 題

4. **技術亮點** (2 分鐘)
   - Proxmox 自動化管理
   - Snapshot/Rollback 機制
   - 腳本化可控故障
   - （如果有做）RAG 出題系統

5. **Q&A** (1 分鐘)

---

## 💡 技術重點說明

### 為什麼選擇「腳本庫」而不是「AI 隨機破壞」？

✅ **優點：**
- **可控性**：每次故障狀態一致，容易除錯
- **可驗證**：check 腳本明確知道如何驗證
- **穩定性**：不會把 VM 破壞到無法修復
- **可擴充**：容易新增更多題目
- **可展示**：Demo 時不會出意外

❌ **AI 隨機破壞的問題：**
- 每次故障不同，很難寫 check 腳本
- 可能破壞關鍵系統檔案導致 VM 無法運作
- 不可預測，Demo 時可能失敗
- 開發時間長，風險高

### 未來如何整合 AI？

保留腳本庫作為基礎，AI 負責：
1. **出題描述**：根據教材生成題目敘述
2. **選擇腳本**：AI 選擇合適的 fault_XX 組合
3. **提示生成**：根據題目內容產生 SRL 提示卡
4. **難度調整**：根據學生程度推薦題目

這樣既有 AI 的亮點，又保證系統穩定！

---

## 📞 需要協助？

如有任何問題，請查看：
- `/scripts/README.md` - 腳本部署說明
- `/src/app.js` - API 端點列表
- `/src/db.js` - 資料庫 Schema

**下一步建議：開始建置 Template VM 並測試第一個題目！** 🚀
